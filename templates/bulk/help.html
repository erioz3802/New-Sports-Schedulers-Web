<!-- templates/bulk/help.html -->
{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2><i class="bi bi-question-circle me-2"></i>Bulk Operations Help</h2>
                <a href="{{ url_for('bulk.dashboard') }}" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left me-1"></i>Back to Dashboard
                </a>
            </div>

            <div class="row">
                <div class="col-lg-3">
                    <!-- Navigation -->
                    <div class="card">
                        <div class="card-header">
                            <h6>Quick Navigation</h6>
                        </div>
                        <div class="list-group list-group-flush">
                            <a href="#getting-started" class="list-group-item list-group-item-action">Getting Started</a>
                            <a href="#template-types" class="list-group-item list-group-item-action">Template Types</a>
                            <a href="#step-by-step" class="list-group-item list-group-item-action">Step-by-Step Guide</a>
                            <a href="#troubleshooting" class="list-group-item list-group-item-action">Troubleshooting</a>
                            <a href="#best-practices" class="list-group-item list-group-item-action">Best Practices</a>
                            <a href="#examples" class="list-group-item list-group-item-action">Examples</a>
                        </div>
                    </div>
                </div>

                <div class="col-lg-9">
                    <!-- Getting Started -->
                    <section id="getting-started" class="mb-5">
                        <div class="card">
                            <div class="card-header bg-primary text-white">
                                <h4><i class="bi bi-play-circle me-2"></i>Getting Started</h4>
                            </div>
                            <div class="card-body">
                                <p class="lead">The bulk operations system allows you to import multiple games at once using Excel templates with user-friendly dropdown menus.</p>
                                
                                <h5>Key Benefits:</h5>
                                <ul>
                                    <li><strong>No ID lookups:</strong> Use friendly names instead of database IDs</li>
                                    <li><strong>Dynamic templates:</strong> Always current with your leagues and officials</li>
                                    <li><strong>Error prevention:</strong> Dropdown menus prevent typos</li>
                                    <li><strong>Conflict detection:</strong> Automatic scheduling conflict warnings</li>
                                    <li><strong>Preview mode:</strong> See what will be imported before saving</li>
                                </ul>

                                <h5>Prerequisites:</h5>
                                <div class="row">
                                    <div class="col-md-4">
                                        <h6><i class="bi bi-trophy me-1"></i>Leagues</h6>
                                        <p class="small">Create your leagues in <a href="{{ url_for('league.manage_leagues') }}">League Management</a> first.</p>
                                    </div>
                                    <div class="col-md-4">
                                        <h6><i class="bi bi-geo-alt me-1"></i>Locations</h6>
                                        <p class="small">Add all venues in <a href="{{ url_for('league.manage_locations') }}">Location Management</a>.</p>
                                    </div>
                                    <div class="col-md-4">
                                        <h6><i class="bi bi-people me-1"></i>Officials</h6>
                                        <p class="small">Ensure official accounts exist in <a href="{{ url_for('admin.manage_users') }}">User Management</a>.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Template Types -->
                    <section id="template-types" class="mb-5">
                        <div class="card">
                            <div class="card-header bg-success text-white">
                                <h4><i class="bi bi-file-earmark-excel me-2"></i>Template Types</h4>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h5><i class="bi bi-calendar-event text-success me-2"></i>Games Only Template</h5>
                                        <p>Use this template when you want to:</p>
                                        <ul>
                                            <li>Create game schedules quickly</li>
                                            <li>Assign officials later manually</li>
                                            <li>Import games without knowing officials yet</li>
                                            <li>Handle assignments through a separate process</li>
                                        </ul>
                                        
                                        <h6>Columns Include:</h6>
                                        <ul class="small">
                                            <li>League Name (dropdown)</li>
                                            <li>Date (YYYY-MM-DD format)</li>
                                            <li>Time (HH:MM format)</li>
                                            <li>Location Name (dropdown)</li>
                                            <li>Field/Court name</li>
                                            <li>Home and Away teams</li>
                                            <li>Game level (Varsity, JV, etc.)</li>
                                            <li>Notes and special instructions</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <h5><i class="bi bi-people-fill text-info me-2"></i>Games with Assignments Template</h5>
                                        <p>Use this template when you want to:</p>
                                        <ul>
                                            <li>Schedule games AND assign officials</li>
                                            <li>Import complete schedules with known officials</li>
                                            <li>Handle tournament or season scheduling</li>
                                            <li>Save time on recurring assignments</li>
                                        </ul>
                                        
                                        <h6>Additional Columns:</h6>
                                        <ul class="small">
                                            <li>Official 1 Name (dropdown)</li>
                                            <li>Official 1 Position</li>
                                            <li>Official 2 Name (dropdown)</li>
                                            <li>Official 2 Position</li>
                                            <li>Official 3 Name (dropdown)</li>
                                            <li>Official 3 Position</li>
                                        </ul>
                                        
                                        <div class="alert alert-info">
                                            <small><i class="bi bi-info-circle me-1"></i>Officials are optional - leave blank if not assigning all positions.</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Step by Step -->
                    <section id="step-by-step" class="mb-5">
                        <div class="card">
                            <div class="card-header bg-info text-white">
                                <h4><i class="bi bi-list-ol me-2"></i>Step-by-Step Guide</h4>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-12">
                                        <h5>Phase 1: Preparation</h5>
                                        <ol>
                                            <li><strong>Verify Data:</strong> Ensure all leagues, locations, and officials exist in the system</li>
                                            <li><strong>Choose Template Type:</strong> Decide between games-only or games-with-assignments</li>
                                            <li><strong>Download Template:</strong> Get the latest template from <a href="{{ url_for('bulk.game_templates') }}">Template Download</a></li>
                                        </ol>

                                        <h5>Phase 2: Fill Template</h5>
                                        <ol start="4">
                                            <li><strong>Open in Excel:</strong> Use Microsoft Excel or compatible software</li>
                                            <li><strong>Read Instructions:</strong> Review the Instructions sheet for detailed guidance</li>
                                            <li><strong>Use Dropdowns:</strong> Always select from dropdown menus - don't type manually</li>
                                            <li><strong>Follow Formats:</strong> 
                                                <ul>
                                                    <li>Date: YYYY-MM-DD (e.g., 2025-12-31)</li>
                                                    <li>Time: HH:MM in 24-hour format (e.g., 14:30 for 2:30 PM)</li>
                                                </ul>
                                            </li>
                                            <li><strong>Remove Sample Data:</strong> Delete the sample row before uploading</li>
                                        </ol>

                                        <h5>Phase 3: Upload and Import</h5>
                                        <ol start="8">
                                            <li><strong>Preview First:</strong> Upload with "Preview Only" mode to check for errors</li>
                                            <li><strong>Review Results:</strong> Check preview data and fix any errors in Excel</li>
                                            <li><strong>Final Import:</strong> Upload again with "Save to Database" mode</li>
                                            <li><strong>Verify Success:</strong> Check imported games in <a href="{{ url_for('game.manage_games') }}">Game Management</a></li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Troubleshooting -->
                    <section id="troubleshooting" class="mb-5">
                        <div class="card">
                            <div class="card-header bg-warning text-dark">
                                <h4><i class="bi bi-tools me-2"></i>Troubleshooting</h4>
                            </div>
                            <div class="card-body">
                                <h5>Common Errors and Solutions:</h5>
                                
                                <div class="accordion" id="troubleshootingAccordion">
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#error1">
                                                "League not found or not accessible"
                                            </button>
                                        </h2>
                                        <div id="error1" class="accordion-collapse collapse show" data-bs-parent="#troubleshootingAccordion">
                                            <div class="accordion-body">
                                                <strong>Cause:</strong> League name doesn't match exactly or you don't have access to it.<br>
                                                <strong>Solution:</strong> 
                                                <ul>
                                                    <li>Use the dropdown menu in Excel - don't type manually</li>
                                                    <li>Check that the league exists in <a href="{{ url_for('league.manage_leagues') }}">League Management</a></li>
                                                    <li>Download a fresh template to get current league list</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#error2">
                                                "Location not found. Add it in Location Management first."
                                            </button>
                                        </h2>
                                        <div id="error2" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                                            <div class="accordion-body">
                                                <strong>Cause:</strong> Location doesn't exist in the system.<br>
                                                <strong>Solution:</strong>
                                                <ul>
                                                    <li>Add the location in <a href="{{ url_for('league.add_location') }}">Location Management</a> first</li>
                                                    <li>Download a new template to get the updated location list</li>
                                                    <li>Use exact location name from dropdown</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#error3">
                                                "Invalid date format"
                                            </button>
                                        </h2>
                                        <div id="error3" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                                            <div class="accordion-body">
                                                <strong>Cause:</strong> Date is not in the correct format or is in the past.<br>
                                                <strong>Solution:</strong>
                                                <ul>
                                                    <li>Use YYYY-MM-DD format (e.g., 2025-12-31)</li>
                                                    <li>Ensure date is today or in the future</li>
                                                    <li>Don't use MM/DD/YYYY or other formats</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#error4">
                                                "Official not found or not accessible"
                                            </button>
                                        </h2>
                                        <div id="error4" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                                            <div class="accordion-body">
                                                <strong>Cause:</strong> Official name doesn't match or they're not in your accessible officials list.<br>
                                                <strong>Solution:</strong>
                                                <ul>
                                                    <li>Use the dropdown menu - don't type names manually</li>
                                                    <li>Ensure official account exists in <a href="{{ url_for('admin.manage_users') }}">User Management</a></li>
                                                    <li>Check that official is in your accessible users list</li>
                                                    <li>Download fresh template for current officials list</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#error5">
                                                "Potential conflict: Same location/field/time already scheduled"
                                            </button>
                                        </h2>
                                        <div id="error5" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                                            <div class="accordion-body">
                                                <strong>Cause:</strong> Another game is already scheduled at the same location, field, and time.<br>
                                                <strong>Solution:</strong>
                                                <ul>
                                                    <li>Check existing games in <a href="{{ url_for('game.manage_games') }}">Game Management</a></li>
                                                    <li>Change the time, date, or field name</li>
                                                    <li>Use a different location if needed</li>
                                                    <li>This is a warning - you can still import if intentional</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Best Practices -->
                    <section id="best-practices" class="mb-5">
                        <div class="card">
                            <div class="card-header bg-secondary text-white">
                                <h4><i class="bi bi-star me-2"></i>Best Practices</h4>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h5>Before Import:</h5>
                                        <ul>
                                            <li>Always download fresh templates</li>
                                            <li>Verify all prerequisite data exists</li>
                                            <li>Use Excel for best dropdown support</li>
                                            <li>Keep template structure intact</li>
                                            <li>Remove sample/instruction rows</li>
                                        </ul>

                                        <h5>During Import:</h5>
                                        <ul>
                                            <li>Use preview mode first</li>
                                            <li>Check all warnings and errors</li>
                                            <li>Fix issues in Excel before final import</li>
                                            <li>Import in smaller batches for large datasets</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <h5>Data Quality:</h5>
                                        <ul>
                                            <li>Use consistent team naming</li>
                                            <li>Standardize game levels (Varsity, JV, etc.)</li>
                                            <li>Include field/court information</li>
                                            <li>Add meaningful notes when needed</li>
                                            <li>Double-check date/time accuracy</li>
                                        </ul>

                                        <h5>Assignment Strategy:</h5>
                                        <ul>
                                            <li>Consider official availability before assigning</li>
                                            <li>Use position names consistently</li>
                                            <li>Leave assignments blank if uncertain</li>
                                            <li>Assign manually later if needed</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Examples -->
                    <section id="examples" class="mb-5">
                        <div class="card">
                            <div class="card-header bg-dark text-white">
                                <h4><i class="bi bi-code-square me-2"></i>Examples</h4>
                            </div>
                            <div class="card-body">
                                <h5>Sample Data Format:</h5>
                                
                                <h6>Games Only Template Example:</h6>
                                <div class="table-responsive">
                                    <table class="table table-bordered table-sm">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>League Name</th>
                                                <th>Date (YYYY-MM-DD)</th>
                                                <th>Time (HH:MM)</th>
                                                <th>Location Name</th>
                                                <th>Field/Court</th>
                                                <th>Home Team</th>
                                                <th>Away Team</th>
                                                <th>Game Level</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>High School Basketball</td>
                                                <td>2025-12-31</td>
                                                <td>19:00</td>
                                                <td>Central High School</td>
                                                <td>Main Gym</td>
                                                <td>Eagles</td>
                                                <td>Hawks</td>
                                                <td>Varsity</td>
                                            </tr>
                                            <tr>
                                                <td>Middle School Soccer</td>
                                                <td>2025-12-31</td>
                                                <td>15:30</td>
                                                <td>City Sports Complex</td>
                                                <td>Field 2</td>
                                                <td>Lions</td>
                                                <td>Tigers</td>
                                                <td>8th Grade</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <h6>Games with Assignments Example:</h6>
                                <div class="table-responsive">
                                    <table class="table table-bordered table-sm">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>League Name</th>
                                                <th>Date</th>
                                                <th>Home Team</th>
                                                <th>Away Team</th>
                                                <th>Official 1 Name</th>
                                                <th>Official 1 Position</th>
                                                <th>Official 2 Name</th>
                                                <th>Official 2 Position</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>High School Basketball</td>
                                                <td>2025-12-31</td>
                                                <td>Eagles</td>
                                                <td>Hawks</td>
                                                <td>John Smith</td>
                                                <td>Referee</td>
                                                <td>Jane Doe</td>
                                                <td>Umpire</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <div class="alert alert-info">
                                    <h6><i class="bi bi-lightbulb me-2"></i>Pro Tips:</h6>
                                    <ul class="mb-0">
                                        <li>Times are in 24-hour format: 14:30 = 2:30 PM, 19:00 = 7:00 PM</li>
                                        <li>All names must exactly match what's in the dropdown menus</li>
                                        <li>Leave official columns blank if not assigning immediately</li>
                                        <li>Use consistent position names like "Referee", "Umpire", "Line Judge"</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Smooth scrolling for navigation links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});
</script>
{% endblock %}